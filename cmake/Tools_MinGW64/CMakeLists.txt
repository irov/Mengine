CMAKE_MINIMUM_REQUIRED(VERSION 3.10)

SET(CMAKE_TOOLCHAIN_FILE "${CMAKE_CURRENT_SOURCE_DIR}/../mingw64_clang_toolchains.cmake")

OPTION(MENGINE_USE_PRECOMPILED_HEADER "Mengine use precompiled header" OFF)

PROJECT(Tools_MinGW64)

INCLUDE(${CMAKE_CURRENT_SOURCE_DIR}/../master_options_template.cmake)
INCLUDE(${CMAKE_CURRENT_SOURCE_DIR}/../base_template.cmake)
INCLUDE(${CMAKE_CURRENT_SOURCE_DIR}/../macro_template.cmake)
INCLUDE(${CMAKE_CURRENT_SOURCE_DIR}/../mingw64_template.cmake)
INCLUDE(${CMAKE_CURRENT_SOURCE_DIR}/../mengine_template.cmake)

SET_MENGINE_ENVIRONMENT(WINDOWS DIRECTX9 WIN32 MINGW)

# output paths
SET(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${MENGINE_REPOSITORY}/lib/${PROJECT_NAME}/${CMAKE_GENERATOR})
SET(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${MENGINE_REPOSITORY}/bin/${PROJECT_NAME}/${CMAKE_GENERATOR})

SET(CMAKE_TEMP_DIR ${CMAKE_BINARY_DIR}/Tools)

# plugins
ADD_PLUGIN(MENGINE_PLUGIN_DEVELOPMENTCONVERTER ON ON "MENGINE_PLUGIN_DEVELOPMENTCONVERTER")
ADD_PLUGIN(MENGINE_PLUGIN_ASTRALAX ON ON "MENGINE_PLUGIN_ASTRALAX")
ADD_PLUGIN(MENGINE_PLUGIN_XMLTOBIN ON ON "MENGINE_PLUGIN_XMLTOBIN")
ADD_PLUGIN(MENGINE_PLUGIN_CURL OFF ON "MENGINE_PLUGIN_CURL")

SET_MENGINE_OUTPUT_DIRECTORY()

INCLUDE_DIRECTORIES(${MENGINE_SOURCE_DIR})
INCLUDE_DIRECTORIES(${MENGINE_SOURCE_DIR}/Tools)
INCLUDE_DIRECTORIES(${THIRDPARTY_DIR}/libmath/include)
INCLUDE_DIRECTORIES(${THIRDPARTY_DIR}/stdex/include)

ADD_SUBDIRECTORY(${MENGINE_SOURCE_DIR}/PrecompiledHeader ${CMAKE_TEMP_DIR}/PrecompiledHeader)
ADD_SUBDIRECTORY(${MENGINE_SOURCE_DIR}/Config ${CMAKE_TEMP_DIR}/Config)
ADD_SUBDIRECTORY(${MENGINE_SOURCE_DIR}/Kernel ${CMAKE_TEMP_DIR}/Kernel)
ADD_SUBDIRECTORY(${MENGINE_SOURCE_DIR}/Engine ${CMAKE_TEMP_DIR}/Engine)
ADD_SUBDIRECTORY(${MENGINE_SOURCE_DIR}/Metacode ${CMAKE_TEMP_DIR}/Metacode)

set(SOURCE_DIR_SYSTEMS ${MENGINE_SOURCE_DIR}/Systems)
set(TEMP_DIR_SYSTEMS ${CMAKE_TEMP_DIR}/Systems)
set(SOURCE_DIR_SERVICES ${MENGINE_SOURCE_DIR}/Services)
set(TEMP_DIR_SERVICES ${CMAKE_TEMP_DIR}/Services)
set(SOURCE_DIR_PLUGINS ${MENGINE_SOURCE_DIR}/Plugins)
set(TEMP_DIR_PLUGINS ${CMAKE_TEMP_DIR}/Plugins)

ADD_SUBDIRECTORY(${SOURCE_DIR_SYSTEMS}/Win32UnicodeSystem ${TEMP_DIR_SYSTEMS}/Win32UnicodeSystem)
ADD_SUBDIRECTORY(${SOURCE_DIR_SYSTEMS}/Win32ThreadSystem ${TEMP_DIR_SYSTEMS}/Win32ThreadSystem)

ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/DocumentService ${TEMP_DIR_SERVICES}/DocumentService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/NotificationService ${TEMP_DIR_SERVICES}/NotificationService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/EnumeratorService ${TEMP_DIR_SERVICES}/EnumeratorService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/FactoryService ${TEMP_DIR_SERVICES}/FactoryService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/ProviderService ${TEMP_DIR_SERVICES}/ProviderService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/StringizeService ${TEMP_DIR_SERVICES}/StringizeService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/ArchiveService ${TEMP_DIR_SERVICES}/ArchiveService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/FileService ${TEMP_DIR_SERVICES}/FileService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/CodecService ${TEMP_DIR_SERVICES}/CodecService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/DataService ${TEMP_DIR_SERVICES}/DataService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/MemoryService ${TEMP_DIR_SERVICES}/MemoryService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/ConverterService ${TEMP_DIR_SERVICES}/ConverterService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/OptionsService ${TEMP_DIR_SERVICES}/OptionsService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/LoggerService ${TEMP_DIR_SERVICES}/LoggerService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/PluginService ${TEMP_DIR_SERVICES}/PluginService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/ThreadService ${TEMP_DIR_SERVICES}/ThreadService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/ConfigService ${TEMP_DIR_SERVICES}/ConfigService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/TextService ${TEMP_DIR_SERVICES}/TextService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/PrototypeService ${TEMP_DIR_SERVICES}/PrototypeService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/VocabularyService ${TEMP_DIR_SERVICES}/VocabularyService)
ADD_SUBDIRECTORY(${SOURCE_DIR_SERVICES}/LoaderService ${TEMP_DIR_SERVICES}/LoaderService)

ADD_SUBDIRECTORY(${MENGINE_SOURCE_DIR}/Platforms/Win32Platform ${CMAKE_TEMP_DIR}/Platforms/Win32Platform)

ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/DevelopmentConverterPlugin ${TEMP_DIR_PLUGINS}/DevelopmentConverterPlugin)
ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/ImageCodecPlugin ${TEMP_DIR_PLUGINS}/ImageCodecPlugin)
ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/XmlToBinPlugin ${TEMP_DIR_PLUGINS}/XmlToBinPlugin)
ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/ZipPlugin ${TEMP_DIR_PLUGINS}/ZipPlugin)
ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/LZ4Plugin ${TEMP_DIR_PLUGINS}/LZ4Plugin)
ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/Movie1Plugin ${TEMP_DIR_PLUGINS}/Movie1Plugin)
ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/MoviePlugin ${TEMP_DIR_PLUGINS}/MoviePlugin)
ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/Win32FileGroupPlugin ${TEMP_DIR_PLUGINS}/Win32FileGroupPlugin)
ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/MetabufLoaderPlugin ${TEMP_DIR_PLUGINS}/MetabufLoaderPlugin)
ADD_SUBDIRECTORY(${SOURCE_DIR_PLUGINS}/AstralaxPlugin ${TEMP_DIR_PLUGINS}/AstralaxPlugin)

ADD_SUBDIRECTORY(${MENGINE_SOURCE_DIR}/Tools ${CMAKE_TEMP_DIR}/Tools)