apply plugin: 'com.android.application'
apply plugin: 'io.fabric'


android {
    signingConfigs {
        config {
            if (project.hasProperty("RELEASE_STORE_FILE")) {
                print 'RELEASE_STORE_FILE = '
                println RELEASE_STORE_FILE

                print 'RELEASE_KEY_ALIAS = '
                println RELEASE_KEY_ALIAS

                storeFile file(RELEASE_STORE_FILE)
                storePassword RELEASE_STORE_PASSWORD
                keyAlias RELEASE_KEY_ALIAS
                keyPassword RELEASE_KEY_PASSWORD
            }
        }
    }
    buildToolsVersion '28.0.3'
    compileSdkVersion 26
    defaultConfig {
//        if (findProperty("ANDROID_APP_ID")) {
//            print 'ANDROID_APP_ID = '
//            println ANDROID_APP_ID
//
//            applicationId ANDROID_APP_ID
//        } else {
//            applicationId "org.Mengine.Build"
//        }
        applicationId "org.Mengine.Build"
        minSdkVersion 18
        versionCode 4
        versionName "1.6"
        ndk {
            abiFilters 'armeabi-v7a'
        }
        signingConfig signingConfigs.config
        targetSdkVersion 26
    }
    buildTypes {
        debug {
            debuggable true
            externalNativeBuild {
                cmake {
                    arguments "-DANDROID_PLATFORM=android-18",
                            "-DANDROID_ARM_NEON=TRUE",
                            "-DANDROID_ABI=armeabi-v7a",
                            "-DANDROID_STL=c++_shared",
                            "-DANDROID_TOOLCHAIN=clang",
                            "-DANDROID_ALLOW_UNDEFINED_SYMBOLS=TRUE",
                            "-DCMAKE_BUILD_TYPE=Debug",
                            "-DCMAKE_CONFIGURATION_TYPES:STRING=Debug",
                            "-DMENGINE_LIB_DIR=build_android_sdl"
                }
            }
        }

        release {
            externalNativeBuild {
                cmake {
                    arguments "-DANDROID_PLATFORM=android-18",
                            "-DANDROID_ARM_NEON=TRUE",
                            "-DANDROID_ABI=armeabi-v7a",
                            "-DANDROID_STL=c++_shared",
                            "-DANDROID_TOOLCHAIN=clang",
                            "-DANDROID_ALLOW_UNDEFINED_SYMBOLS=TRUE",
                            "-DCMAKE_BUILD_TYPE=Release",
                            "-DCMAKE_CONFIGURATION_TYPES:STRING=Release",
                            "-DMENGINE_LIB_DIR=build_android_sdl"
                }
            }
        }
    }
    externalNativeBuild {
        cmake {
            path "../../CMake/Android_SDL/CMakeLists.txt"
        }
    }
    sourceSets {
        main {
            manifest.srcFile 'AndroidManifest.xml'
            java.srcDirs = ['src', '../../dependencies/SDL2/android-project/app/src/main/java/']
            res.srcDirs = ['res']

			if (findProperty("ASSETS_SRC_DIR")) {
                print 'ASSETS_SRC_DIR = '
                println ASSETS_SRC_DIR

                assets.srcDirs = [ASSETS_SRC_DIR]
            } else {
                assets.srcDirs = ['data']
            }
        }
    }
    aaptOptions {
        noCompress 'pak', 'bin'
    }
    productFlavors {
    }
}

dependencies {
    implementation fileTree(include: ['*.jar'], dir: 'libs')
    implementation 'com.android.support:appcompat-v7:27.1.0'
    implementation 'com.devtodev:android:1.13'
    implementation 'com.google.android.gms:play-services-base:15.0.1'
    implementation 'com.google.android.gms:play-services-ads:15.0.0'
    implementation 'com.android.support.constraint:constraint-layout:1.0.2'
    implementation 'com.facebook.android:facebook-android-sdk:[4,5)'
    testImplementation 'junit:junit:4.12'
    androidTestImplementation 'com.android.support.test:runner:1.0.1'
    androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.1'
    implementation project(':libraries:SDL2')
    implementation project(':libraries:OpenAL32')
    implementation project(':unity-ads')
    implementation 'com.google.firebase:firebase-core:16.0.1'
    implementation 'com.google.firebase:firebase-core:16.0.8'
    implementation 'com.crashlytics.sdk.android:crashlytics:2.9.9'
}
apply plugin: 'com.google.gms.google-services'