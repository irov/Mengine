import com.Mengine.Utils

apply from: rootProject.projectDir.getAbsolutePath() + '/libraries/library.gradle'

def ANDROID_APP_BUILD_NUMBER = Utils.getIntegerProperty(project, "ANDROID_APP_BUILD_NUMBER", 0)
def ANDROID_APP_BUILD_PUBLISH = Utils.getBooleanProperty(project, "ANDROID_APP_BUILD_PUBLISH", false)
def ANDROID_APP_LOGGER_LEVEL_FORCE_VERBOSE = Utils.getBooleanProperty(project, "ANDROID_APP_LOGGER_LEVEL_FORCE_VERBOSE", false)

android {
    externalNativeBuild {
        cmake {
            path "../../../cmake/Android_SDL/CMakeLists.txt"
        }
    }

    buildTypes {
        debug {
            externalNativeBuild {
                cmake {
                    arguments "-DANDROID_PLATFORM=android-" + project.minSdkVersion,
                            "-DANDROID_ARM_NEON=TRUE",
                            "-DANDROID_STL=c++_shared",
                            "-DANDROID_TOOLCHAIN=clang",
                            "-DANDROID_ALLOW_UNDEFINED_SYMBOLS:BOOLEAN=TRUE",
                            "-DMENGINE_BUILD_VERSION:STRING=" + ANDROID_APP_BUILD_NUMBER,
                            "-DMENGINE_BUILD_MENGINE_BUILD_PUBLISH=" + (ANDROID_APP_BUILD_PUBLISH ? "ON" : "OFF"),
                            "-DMENGINE_BUILD_MENGINE_LOGGER_LEVEL_FORCE_VERBOSE=" + (ANDROID_APP_LOGGER_LEVEL_FORCE_VERBOSE ? "ON" : "OFF"),
                            "-DMENGINE_BUILD_MENGINE_MASTER_RELEASE=OFF",
                            "-DMENGINE_BUILD_MENGINE_DEVELOPMENT=ON",
                            "-DCMAKE_BUILD_TYPE:STRING=Debug"
                }
            }
        }

        release {
            externalNativeBuild {
                cmake {
                    arguments "-DANDROID_PLATFORM=android-" + project.minSdkVersion,
                            "-DANDROID_ARM_NEON=TRUE",
                            "-DANDROID_STL=c++_shared",
                            "-DANDROID_TOOLCHAIN=clang",
                            "-DANDROID_ALLOW_UNDEFINED_SYMBOLS:BOOLEAN=TRUE",
                            "-DMENGINE_BUILD_VERSION:STRING=" + ANDROID_APP_BUILD_NUMBER,
                            "-DMENGINE_BUILD_MENGINE_BUILD_PUBLISH=" + (ANDROID_APP_BUILD_PUBLISH ? "ON" : "OFF"),
                            "-DMENGINE_BUILD_MENGINE_LOGGER_LEVEL_FORCE_VERBOSE=" + (ANDROID_APP_LOGGER_LEVEL_FORCE_VERBOSE ? "ON" : "OFF"),
                            "-DMENGINE_BUILD_MENGINE_MASTER_RELEASE=ON",
                            "-DMENGINE_BUILD_MENGINE_DEVELOPMENT=OFF",
                            "-DCMAKE_BUILD_TYPE:STRING=Release"
                }
            }
        }
    }

    preBuild.dependsOn ":libraries:SDL:build", ":libraries:OpenAL32:build"

    namespace "org.Mengine.Base"
}

dependencies {
    implementation project(':libraries:SDL')
    implementation project(':libraries:OpenAL32')
}
