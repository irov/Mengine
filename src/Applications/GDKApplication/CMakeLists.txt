MENGINE_PROJECT(GDKApplication)

if(MENGINE_TOOLCHAIN_MSVC)
ADD_FILTER(
main
    GDKMain.cpp
)
endif()
    
ADD_FILTER(
GDKApplication
    GDKApplication.cpp
    GDKApplication.h
)

LINK_DIRECTORIES(${CMAKE_ARCHIVE_OUTPUT_DIRECTORY})

set(CMAKE_CXX_STACK_SIZE 4194304)

ADD_MENGINE_EXECUTABLE_WIN32()

TARGET_LINK_LIBRARIES(${PROJECT_NAME} Kernel)

if(MENGINE_PLUGIN_MENGINE_STATIC)
    TARGET_LINK_LIBRARIES(${PROJECT_NAME} Mengine)
else()
    ADD_DEPENDENCIES(${PROJECT_NAME} Mengine)
endif()

TARGET_LINK_LIBRARIES(${PROJECT_NAME} Windows)

if(MENGINE_PLUGIN_MENGINE_STATIC)
    if(APPLICATION_LINK_LIBRARIES)
        TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${APPLICATION_LINK_LIBRARIES})
    endif()
    
    if(APPLICATION_DEPENDENCIES)
        ADD_DEPENDENCIES(${PROJECT_NAME} ${APPLICATION_DEPENDENCIES})
    endif()
endif()

if(NOT MENGINE_TOOLCHAIN_MSVC)
    TARGET_LINK_LIBRARIES(${PROJECT_NAME} libole32.a)
    TARGET_LINK_LIBRARIES(${PROJECT_NAME} atomic)
endif()

if(MENGINE_TOOLCHAIN_MSVC)
    set_target_properties(${PROJECT_NAME} PROPERTIES LINK_FLAGS /NODEFAULTLIB:"libci.lib")
endif()

if(MENGINE_TOOLCHAIN_MSVC)
    set_property(DIRECTORY ${CMAKE_SOURCE_DIR} PROPERTY VS_STARTUP_PROJECT ${PROJECT_NAME})
endif()