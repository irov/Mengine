#include "ReferenceCounter.h"

#include "Kernel/Assertion.h"

namespace Mengine
{
    //////////////////////////////////////////////////////////////////////////
    ReferenceCounter::ReferenceCounter()
        : m_counter( 0 )
    {
    }
    //////////////////////////////////////////////////////////////////////////
    ReferenceCounter::ReferenceCounter( uint32_t _counter )
        : m_counter( _counter )
    {
    }
    //////////////////////////////////////////////////////////////////////////
    ReferenceCounter::~ReferenceCounter()
    {
        MENGINE_ASSERTION_FATAL( m_counter == 0, "reference count is not zero '%u'"
            , m_counter.load()
        );
    }
    //////////////////////////////////////////////////////////////////////////
    void ReferenceCounter::setReferenceCount( uint32_t _counter )
    {
        m_counter = _counter;
    }
    //////////////////////////////////////////////////////////////////////////
    uint32_t ReferenceCounter::incref()
    {
        return m_counter++;
    }
    //////////////////////////////////////////////////////////////////////////
    uint32_t ReferenceCounter::decref()
    {
        return --m_counter;
    }
    //////////////////////////////////////////////////////////////////////////
    void ReferenceCounter::reset()
    {
        m_counter = 0;
    }
    //////////////////////////////////////////////////////////////////////////
}
