MENGINE_PROJECT(Win32SentryPlugin)

ADD_FILTER(
src
    Win32SentryInterface.h

    Win32SentryPlugin.h
    Win32SentryPlugin.def
    Win32SentryPlugin.cpp
    
    Win32SentryLoggerCapture.h
    Win32SentryLoggerCapture.cpp
    
    Win32SentryService.h
    Win32SentryService.cpp
)

add_definitions(-DSENTRY_BUILD_STATIC)
    
include_directories(${THIRDPARTY_DIR}/sentry/include)

ADD_MENGINE_PLUGIN(MENGINE_PLUGIN_SENTRY)

TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}stdex${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}math${MENGINE_LIB_SUFFIX})

TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}sentry${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}mini_chromium${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}crashpad_client${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}crashpad_minidump${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}crashpad_snapshot${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}crashpad_tools${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}crashpad_util${MENGINE_LIB_SUFFIX})

TARGET_LINK_LIBRARIES(${PROJECT_NAME} Winhttp.lib)
TARGET_LINK_LIBRARIES(${PROJECT_NAME} Rpcrt4.lib)
TARGET_LINK_LIBRARIES(${PROJECT_NAME} Dbghelp.lib)
TARGET_LINK_LIBRARIES(${PROJECT_NAME} Version.lib)

TARGET_LINK_LIBRARIES(${PROJECT_NAME} Kernel)

IF(MENGINE_TARGET_WINDOWS)
    TARGET_LINK_LIBRARIES(${PROJECT_NAME} Windows)
ENDIF()