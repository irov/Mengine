set(MY_LIB_NAME cURLPlugin)

ADD_FILTER(
src
	cURLPlugin.h
	cURLPlugin.cpp
    cURLPlugin.def
    
    cURLInterface.h
    
    cURLService.cpp
    cURLService.h
    
    cURLThreadTask.cpp
    cURLThreadTask.h
    cURLGetAssetThreadTask.cpp
    cURLGetAssetThreadTask.h
    cURLGetMessageThreadTask.cpp
    cURLGetMessageThreadTask.h
    cURLHeaderDataThreadTask.cpp
    cURLHeaderDataThreadTask.h
    cURLPostMessageThreadTask.cpp
    cURLPostMessageThreadTask.h
    
    cURLErrorHelper.cpp
    cURLErrorHelper.h
    
    cURLSource.h
    cURLSource.cpp
    
    TaskcURLHttpBase.cpp
    TaskcURLHttpBase.h
    TaskcURLHttpGet.cpp
    TaskcURLHttpGet.h
    TaskcURLHttpHeaderData.cpp
    TaskcURLHttpHeaderData.h
    TaskcURLHttpPost.cpp
    TaskcURLHttpPost.h
)
    
if(MENGINE_USE_SCRIPT_SERVICE)
    ADD_FILTER(
    embedding
        cURLScriptEmbedding.cpp
        cURLScriptEmbedding.h
        )    

    INCLUDE_DIRECTORIES(${THIRDPARTY_DIR}/pybind/include)    
endif()

add_definitions(-DCURL_STATICLIB)

IF(NOT MENGINE_TOOLCHAIN_GRADLE)
    INCLUDE_DIRECTORIES(${THIRDPARTY_DIR}/curl/include)
ENDIF()

IF(MENGINE_TOOLCHAIN_GRADLE)
    INCLUDE_DIRECTORIES(${THIRDPARTY_DIR}/curl/include)
    #INCLUDE_DIRECTORIES(${THIRDPARTY_DIR}/curl-android/libs/${ANDROID_ABI}/include)
ENDIF()

INCLUDE_DIRECTORIES(${MENGINE_CMAKE_DEPENDENCIES_DIR}/GOAP/Config)
INCLUDE_DIRECTORIES(${THIRDPARTY_DIR}/GOAP/include)

ADD_MENGINE_PLUGIN(MENGINE_PLUGIN_CURL)

TARGET_LINK_LIBRARIES(${MY_LIB_NAME} Kernel)

IF(MENGINE_TARGET_WINDOWS OR MENGINE_TARGET_MINGW)
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/libcurl${MENGINE_LIB_SUFFIX})
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ws2_32.lib)
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} Crypt32.lib)
ENDIF()

IF(MENGINE_TARGET_IOS)
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}curl${MENGINE_LIB_SUFFIX})
ENDIF()

IF(MENGINE_TARGET_ANDROID)
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}curl${MENGINE_LIB_SUFFIX})
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_DIR}/openssl_android/lib/${ANDROID_ABI}/${MENGINE_LIB_PREFIX}ssl${MENGINE_LIB_SUFFIX})
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_DIR}/openssl_android/lib/${ANDROID_ABI}/${MENGINE_LIB_PREFIX}crypto${MENGINE_LIB_SUFFIX})
ENDIF()

IF(MENGINE_TARGET_UNIX)
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}curl${MENGINE_LIB_SUFFIX})
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} /usr/local/ssl/lib/libssl.a)
    TARGET_LINK_LIBRARIES(${MY_LIB_NAME} /usr/local/ssl/lib/libcrypto.a)
ENDIF()

TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}stdex${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}pybind${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}zlib${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES(${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}GOAP${MENGINE_LIB_SUFFIX})